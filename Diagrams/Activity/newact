@startuml
start
:Регистрация/авторизация клиента;


if(У клиента есть учетная запись на сайте) then(да)
:Клиент входит в существующий аккаунт;
else(нет)
:Клиент регистрируется на сайте;
endif
:Система подтверждает учётные данные клиента;


:Клиент выбирает товары и добавляет их в корзину;

:Клиент переходит к оформлению заказа;

fork
    :выбор способ доставки;
fork again
    :выбор способа оплаты;
end fork
:Система проверяет наличие каждого товара в выбранных количествах;

if(Товар и нужное количество есть на складе) then (да)
    :Оплата;
    fork
    :Клиент переходит к оплате товара.
     выбирает способ оплаты(кредитная карта,
     PayPal,
     банковский перевод и т. д.);
    fork again
    :Система
    проверяет платёжные детали
    и производит транзакцию;


    end fork
if(Оплата прошла успешно) then(да)
   fork
   :Генерируется счёт-фактура;
    fork again
    :Отправляется уведомление клиенту о подтверждении заказа и статусе доставки;
    fork again
    :Заказ переходит в статус «Отправлен»;
    end fork


    :Отправка;
    fork
    :Система уведомляет склад о необходимости собрать заказ;
    fork again
    :Сотрудники склада комплектуют заказ по списку;
    end fork
else(нет)
fork
:Отправляется уведомление клиенту о проблеме с платежом;
fork again
:Клиенту предлагается повторить попытку оплаты или изменить способ оплаты;
    if(клиента устраивает решение ?) then (да)
    :повторить попытку;
    else(нет)
    :вернуть средства;
    endif
end fork
endif
:Уведомление клиента о статусах;
else(нет)
    :Товар отстутствует;
    fork
    :Уведомление клиента о недоступности товара;
    fork again
    :Возможность выбрать альтернативный товар или удалить отсутствующий из заказа;
    end fork
endif
:Уведомление клиента о статусе;

stop
@enduml
